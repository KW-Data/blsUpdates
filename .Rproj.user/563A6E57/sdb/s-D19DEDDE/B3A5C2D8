{
    "collab_server" : "",
    "contents" : "\n# library(devtools)\n# install_github(\"mikeasilva/blsAPI\")\nlibrary(blsAPI)\nlibrary(RCurl)\nlibrary(RJSONIO)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(plotly)\n\n####Load and clean data\n#Start and End Years for BLS data and Month to Filter\nstartYear <- 2007\nendYear   <- 2017\nblsMonth  <- 'March'\napiKey    <- '2691a2506f514617823b4e653111fdc9'\n#,'startyear'= startYear, 'endyear' = endYear\n#Load data and parse it out with RJSONIO\n#BLS series LNS14000000 returns the Seasonally Adjusted Unemployment Rate for individuals 16 and over.\n\n###########################################################################################################\n## FUNCTIONS ##\n###########################################################################################################\n#Convert Data from BLS API to DataFrame\napiDataConverter <- function(seriesId) {\n       payload     <- list('seriesid'        = seriesId,\n                           'startyear'       = startYear, \n                           'endyear'         = endYear, \n                           'registrationKey' = apiKey)\n       bls.content <- blsAPI(payload)\n       bls.json    <- fromJSON(bls.content, simplify=TRUE)\n       tmp         <- bls.json$Results[[1]][[1]]\n       bls.df      <- data.frame(year=sapply(tmp$data,\"[[\",\"year\"),\n                                 period=sapply(tmp$data,\"[[\",\"period\"),\n                                 periodName=sapply(tmp$data,\"[[\",\"periodName\"),\n                                 value=as.numeric(sapply(tmp$data,\"[[\",\"value\")),\n                                 stringsAsFactors=FALSE)\n}\n\n###########################################################################################################\n## CREATE DATAFRAMES AND FORMAT ##\n###########################################################################################################\n\n#### Labor Force Series ID's ###\nJeffersonCountyLaborForce <- apiDataConverter(\"LAUCN211110000000006\")\nKentuckyLaborForce        <- apiDataConverter(\"LAUST210000000000006\")\nLouisvilleLaborForce      <- apiDataConverter(\"LAUMT213114000000006\")\nUnitedStatesLaborForce    <- apiDataConverter(\"LNU01000000\")\n\n#### Employment  Series ID's ###\nJeffersonCountyEmployment <- apiDataConverter(\"LAUCN211110000000005\")\nKentuckyEmployment        <- apiDataConverter(\"LAUST210000000000005\")\nLouisvilleEmployment      <- apiDataConverter(\"LAUMT213114000000005\")\n\n### Unemployment Rate Series ID's ###\nJeffersonCountyUnemployment <- apiDataConverter(\"LAUCN211110000000003\")\nKentuckyUnemployment        <- apiDataConverter(\"LAUST210000000000003\")\nLouisvilleUnemployment      <- apiDataConverter(\"LAUMT213114000000003\")\nUnitedStatesUnemployment    <- apiDataConverter(\"LNU04000000\")\n\n\n#Add area variable to data\n### Labor Force ###\nJeffersonCountyLaborForce$area   <- \"Jefferson County\"\nKentuckyLaborForce$area          <- \"Kentucky\"\nLouisvilleLaborForce$area        <- \"Louisville MSA\"\nUnitedStatesLaborForce$area      <- \"United States\"\n#UnitedStatesLaborForce$value    <- (UnitedStatesLaborForce$value)*1000\n\n###  Employment ###\nJeffersonCountyEmployment$area   <- \"Jefferson County\"\nKentuckyEmployment$area          <- \"Kentucky\"\nLouisvilleEmployment$area        <- \"Louisville MSA\"\n\n### Unemployment ###\nJeffersonCountyUnemployment$area <- \"Jefferson County\"\nKentuckyUnemployment$area        <- \"Kentucky\"\nLouisvilleUnemployment$area      <- \"Louisville MSA\"\nUnitedStatesUnemployment$area    <- \"United States\"\n\n\n################### Combine dataframes\n### Labor Force ###\nlaborForceData       <- rbind(JeffersonCountyLaborForce, \n                              #KentuckyLaborForce, \n                              LouisvilleLaborForce)\n\n### Employment ###\nemploymentData       <- rbind(JeffersonCountyEmployment, \n                              #KentuckyEmployment, \n                              LouisvilleEmployment)\n\n### Unemployment ###\nunemploymentRateData <- rbind(UnitedStatesUnemployment,\n                              KentuckyUnemployment, \n                              LouisvilleUnemployment, \n                              JeffersonCountyUnemployment\n)\n\n################## Filter for specified month\n### Labor Force ###\nlaborForceData       <- laborForceData %>% filter(periodName == blsMonth)\n\n###  Employment ###\nemploymentData       <- employmentData %>% filter(periodName == blsMonth)\n\n### Unemployment ###\nunemploymentRateData <- unemploymentRateData %>% filter(periodName == blsMonth)\n\nsave(laborForceData,       file = \"laborForce.Rda\")\nsave(employmentData,       file = \"employment.Rda\")\nsave(unemploymentRateData, file = \"unemployment.Rda\")\n",
    "created" : 1482162540884.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2723133838",
    "id" : "B3A5C2D8",
    "lastKnownWriteTime" : 1494428549,
    "last_content_update" : 1494428549952,
    "path" : "~/Desktop/shinyBlsUpdates/dataUpdate.R",
    "project_path" : "dataUpdate.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}