{
    "collab_server" : "",
    "contents" : "# What's the total number for our MSA?  For the state of KY?\n\nlibrary(RCurl)\nlibrary(dplyr)\nlibrary(plotrix)\nlibrary(scales)\nlibrary(plotly)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(treemap)\n\n# Add data\nyouth16to19 <- read.csv(\"youth16to19.csv\")\nyouth16to21 <- read.csv(\"youth16to21.csv\")\n\nyouth16to19Title <- \"Youth 16 to 19\"\nyouth16to21Title <- \"Youth 16 to 21\"\n\n\ncleanData <- function(enterDataHere) {\n  dataOutput <- enterDataHere %>% \n    mutate(race =\n             ifelse(RAC1P == 1 & HISP == 01, \"Non-Hispanic white\",\n                    ifelse(RAC1P == 2, \"Black\",\n                           ifelse(HISP > 1, \"Hispanic\", \"Other\")))) %>%\n    mutate(education = \n             ifelse(SCHL < 16, \"Less than high school\", \n                    ifelse(SCHL == 16 | SCHL == 17 , \"High school diploma or equivalent\", \n                           ifelse(SCHL == 18 | SCHL == 19, \"Some college, no degree\", \n                                  ifelse(SCHL == 20, \"Associate's degree\", \n                                         ifelse(SCHL == 21, \"Bachelor's degree\", \n                                                ifelse(SCHL == 22 | SCHL == 24, \"Graduate degree\", \n                                                       ifelse(SCHL == 23, \"Professional degree beyond bachelor's degree\", \"Other\")))))))) %>% \n    mutate(householdIncome = \n             ifelse(HINCP < 30000, \"< $30k\", \n                    ifelse((HINCP >= 30000 & HINCP < 60000), \"$30k - $60k\", \n                           ifelse((HINCP >= 60000 & HINCP < 90000), \"$60k - $90k\",\n                                  ifelse((HINCP >= 90000 & HINCP <120000), \"$90k - $120k\",\n                                         ifelse((HINCP >= 120000 & HINCP < 150000), \"$120k - $150k\", \n                                                ifelse((HINCP >= 150000 & HINCP < 180000), \"$150k - $180k\",\n                                                       ifelse((HINCP >= 180000 & HINCP < 210000), \"$180k - $210k\",\n                                                              ifelse(HINCP >= 210000, \"> 210k\", \"Other\"))))))))) %>% \n    mutate(sex = \n             ifelse(SEX == 1, \"Male\", \n                    ifelse(SEX == 2, \"Female\", \"Other\")))\n}\n\n\n## Disability data\ndisabilityClean <- function(enterDataHere) {\n  disability <- enterDataHere %>% \n    mutate(visual = ifelse(DEYE == 1, 1, 0)) %>% \n    mutate(hearing = ifelse(DEAR == 1, 1, 0)) %>% \n    mutate(ambulatory = ifelse(DPHY == 1, 1, 0)) %>% \n    mutate(cognitive = ifelse(DREM == 1, 1, 0)) %>% \n    mutate(selfCare = ifelse(DDRS == 1, 1, 0)) %>% \n    mutate(independentLiving = ifelse(DOUT == 1, 1, 0)) %>% \n    select(visual, hearing, ambulatory, cognitive, selfCare, independentLiving, PWGTP, DIS) \n  \n  disabilityData <- disability %>% mutate(disability =\n                                            ifelse((visual == 1 & hearing == 0 & ambulatory == 0 & cognitive == 0 & selfCare == 0 & independentLiving == 0), \"Visual\", \n                                                   ifelse((visual == 0 & hearing == 1 & ambulatory == 0 & cognitive == 0 & selfCare == 0 & independentLiving == 0), \"Hearing\", \n                                                          ifelse((visual == 0 & hearing == 0 & ambulatory == 1 & cognitive == 0 & selfCare == 0 & independentLiving == 0), \"Ambulatory\", \n                                                                 ifelse((visual == 0 & hearing == 0 & ambulatory == 0 & cognitive == 1 & selfCare == 0 & independentLiving == 0), \"Cognitive\", \n                                                                        ifelse((visual == 0 & hearing == 0 & ambulatory == 0 & cognitive == 0 & selfCare == 1 & independentLiving == 0), \"Self-Care\", \n                                                                               ifelse((visual == 0 & hearing == 0 & ambulatory == 0 & cognitive == 0 & selfCare == 0 & independentLiving == 1), \"Independent Living\", \n                                                                                      ifelse((DIS == 1 & sum(visual, hearing, ambulatory, cognitive, selfCare, independentLiving) > 1), \"Multiple disabilities\", \n                                                                                             ifelse(DIS == 2, \"Without disability\", \"Other\")))))))))\n}\n\nyouth16to19Disability <- disabilityClean(youth16to19)\nyouth16to21Disability <- disabilityClean(youth16to21)\n\n## Disability\n# 16 - 19\nyouth16to19Disability <- dplyr::count(youth16to19Disability, disability, wt = PWGTP)\nyouth16to19Disability$percent <- percent(youth16to19Disability$n/sum(youth16to19Disability$n))\nyouth16to19Disability$label <- paste(youth16to19Disability$disability, \"\\n\", youth16to19Disability$percent)\nView(youth16to19Disability)\n\ntreemap(youth16to19Disability, \"label\", \"n\", title = youth16to19Title)\n\n# 16 - 21\nyouth16to21Disability <- count(youth16to21Disability, disability, wt = PWGTP)\nyouth16to21Disability$percent <- percent(youth16to21Disability$n/sum(youth16to21Disability$n))\nyouth16to21Disability$label <- paste(youth16to21Disability$disability, \"\\n\", youth16to21Disability$percent)\nView(youth16to21Disability)\n\ntreemap(youth16to21Disability, \"label\", \"n\", title = youth16to21Title)\n\n# popluationDisabilitySpread <- populationDisability %>% select(State, disability, percent) %>% spread(disability, percent)\n# notInLaborForceDisabilitySpread <- notInLaborForceDisability %>% select(State, disability, percent) %>% spread(disability, percent)\n# unemployedDisabilitySpread <- unemployedDisability %>% select(State, disability, percent) %>% spread(disability, percent)\n# \n# disabilityData <- rbind(popluationDisabilitySpread, unemployedDisabilitySpread, notInLaborForceDisabilitySpread)\n# write.csv(disabilityData, file = \"disabilityData.csv\")\n# \n# # treemap(disabilityCount, \"label\", \"n\", title = \"\")\n\nyouth16to19Clean <- cleanData(youth16to19)\nyouth16to21Clean <- cleanData(youth16to21)\n\n## By race\n#16 - 19\nyouth16to19Race <- count(youth16to19Clean, race, wt = PWGTP)\nyouth16to19Race$percent <- percent(youth16to19Race$n/sum(youth16to19Race$n))\nyouth16to19Race$label <- paste(youth16to19Race$race, \"\\n\", youth16to19Race$percent)\n\ntreemap(youth16to19Race, \"label\", \"n\", title = youth16to19Title)\n\n\n#16 - 21\nyouth16to21Race <- dplyr::count(youth16to21Clean, race, wt = PWGTP)\nyouth16to21Race$percent <- percent(youth16to21Race$n/sum(youth16to21Race$n))\nyouth16to21Race$label <- paste(youth16to21Race$race, \"\\n\", youth16to21Race$percent)\n\ntreemap(youth16to21Race, \"label\", \"n\", title = youth16to21Title)\n\n\n# notInLaborForceRaceSpread <- notInLaborForceRace %>% select(State, race, percent) %>% spread(race, percent)\n# unemployedRaceSpread <- unemployedRace %>% select(State, race, percent) %>% spread(race, percent)\n# \n# raceData <- rbind(sixteenPlusRaceSpread, unemployedRaceSpread, notInLaborForceRaceSpread)\n# \n# treemap(race, \"label\", \"n\", title = \"\")\n\n\n# ## education\n# populationEducation <- count(sixteenPlusClean, education, wt = PWGTP)\n# populationEducation$percent <- (populationEducation$n/sum(populationEducation$n))\n# #populationEducation$label <- paste(populationEducation$education, \"\\n\", populationEducation$percent)\n# populationEducation$State <- \"Population\"\n# \n# notInLaborForceEducation <- count(notInLaborForceClean, education, wt = PWGTP)\n# notInLaborForceEducation$percent <- (notInLaborForceEducation$n/sum(notInLaborForceEducation$n))\n# #notInLaborForceEducation$label <- paste(notInLaborForceEducation$education, \"\\n\", notInLaborForceEducation$percent)\n# notInLaborForceEducation$State <- \"Not in Labor Force\"\n# \n# unemployedEducation <- count(unemployedClean, education, wt = PWGTP)\n# unemployedEducation$percent <- (unemployedEducation$n/sum(unemployedEducation$n))\n# #unemployedEducation$label <- paste(unemployedEducation$education, \"\\n\", unemployedEducation$percent)\n# unemployedEducation$State <- \"Unemployed\"\n# \n# populationEducationSpread <- populationEducation %>% select(State, education, percent) %>% spread(education, percent)\n# notInLaborForceEducationSpread <- notInLaborForceEducation %>% select(State, education, percent) %>% spread(education, percent)\n# unemployedEducationSpread <- unemployedEducation %>% select(State, education, percent) %>% spread(education, percent)\n# \n# educationData <- rbind(populationEducationSpread, unemployedEducationSpread, notInLaborForceEducationSpread)\n# write.csv(educationData, file = \"educationData.csv\")\n\n\n#treemap(education, \"label\", \"n\", title = \"\")\n\n\n## Sex\n\nyouth16to19Sex <- count(youth16to19Clean, sex, wt = PWGTP)\nyouth16to19Sex$percent <-  percent(youth16to19Sex$n/sum(youth16to19Sex$n))\nyouth16to19Sex$label <- paste(youth16to19Sex$sex, \"\\n\", youth16to19Sex$percent)\n\ntreemap(youth16to19Sex, \"label\", \"n\", title = youth16to19Title)\n\n\nyouth16to21Sex <- dplyr::count(youth16to21Clean, sex, wt = PWGTP)\nyouth16to21Sex$percent <-  percent(youth16to21Sex$n/sum(youth16to21Sex$n))\nyouth16to21Sex$label <- paste(youth16to21Sex$sex, \"\\n\", youth16to21Sex$percent)\n\ntreemap(youth16to21Sex, \"label\", \"n\", title = youth16to21Title)\n\n\n# sixteenPlusSexSpread <- sixteenPlusSex %>% select(State, SEX, percent) %>% spread(SEX, percent)\n# notInLaborForceSexSpread <- notInLaborForceSex %>% select(State, SEX, percent) %>% spread(SEX, percent)\n# unemployedSexSpread <- unemployedSex %>% select(State, SEX, percent) %>% spread(SEX, percent)\n# \n# sexData <- rbind(sixteenPlusSexSpread, unemployedSexSpread, notInLaborForceSexSpread)\n# write.csv(sexData, file = \"sexData.csv\")\n\n\n\n\n## Household Age\n#16-19\nyouth16to19Income <- count(youth16to19Clean, householdIncome, wt = PWGTP)\nyouth16to19Income <- na.omit(youth16to19Income)\nyouth16to19Income$percent <- percent(youth16to19Income$n/sum(youth16to19Income$n))\nyouth16to19Income$label <- paste(youth16to19Income$householdIncome, \"\\n\", youth16to19Income$percent)\n\ntreemap(youth16to19Income, \"label\", \"n\", title = youth16to19Title)\n\n#16-21\nyouth16to21Income <- count(youth16to21Clean, householdIncome, wt = PWGTP)\nyouth16to21Income <- na.omit(youth16to21Income)\nyouth16to21Income$percent <- percent(youth16to21Income$n/sum(youth16to21Income$n))\nyouth16to21Income$label <- paste(youth16to21Income$householdIncome, \"\\n\", youth16to21Income$percent)\n\ntreemap(youth16to21Income, \"label\", \"n\", title = youth16to21Title)\n\n\n\n\n## AGE\n\n#16-19\nyouth16to19Age <- count(youth16to19Clean, AGEP, wt = PWGTP)\nyouth16to19Age <- na.omit(youth16to19Age)\nyouth16to19Age$percent <- percent(youth16to19Age$n/sum(youth16to19Age$n))\nyouth16to19Age$label <- paste(youth16to19Age$AGEP, \"\\n\", youth16to19Age$percent)\n\ntreemap(youth16to19Age, \"label\", \"n\", title = youth16to19Title)\n\n#16-21\nyouth16to21Age <- count(youth16to21Clean, AGEP, wt = PWGTP)\nyouth16to21Age <- na.omit(youth16to21Age)\nyouth16to21Age$percent <- percent(youth16to21Age$n/sum(youth16to21Age$n))\nyouth16to21Age$label <- paste(youth16to21Age$AGEP, \"\\n\", youth16to21Age$percent)\n\ntreemap(youth16to21Age, \"label\", \"n\", title = youth16to21Title)\n\n\n\n\n",
    "created" : 1491409251841.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3509161089",
    "id" : "34F657CF",
    "lastKnownWriteTime" : 1491233191,
    "last_content_update" : 1491233191,
    "path" : "~/Desktop/rProjects/rstudioWork/pums2015/mainOpportunityYouth.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}